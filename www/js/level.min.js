var PG;(function(n){var t=function(){function t(t){this.levelNumber=t,this.lastNextOrBackTime=null;var i=this;touchwipe({wipeLeft:function(){return i.next()},wipeRight:function(){return i.back()}},window),$.when($.get("js/bookmarks.js"),$.get("data/"+t+".js",null,null,"text")).done(function(r,u){var e,f,o,s;i.bookmarks=new n.Bookmarks,e=u[0],f=JSON.parse(e),$("h1").text(f.name[app.nativeLang].Native),o=$("#steps"),s=$("#steps li.level-step").remove(),f.words.forEach(function(n){var i=s.clone(),r;i.attr("data-stepid",n.id),i.find(".target").text(n.translations[app.targetLang].Target),i.find(".image img").attr("src","http://m.babelbay.com/LevelsMedia/Set"+t+"/"+n.id+".jpg"),i.find(".native").text(n.translations[app.nativeLang].Native),r=new Audio("http://m.babelbay.com/services/tts.ashx?lang="+app.targetLang+"&level="+t+"&id="+n.id),r.preload="auto",i[0].audio=r,o.append(i)}),i.goto(0)}).fail(function(){console.log("error",arguments)})}return t.prototype.showElStep=function(n){n.addClass("current");var t=parseInt(n.attr("data-stepid"));$("body")[this.bookmarks.isBookmarked(this.levelNumber,t)?"addClass":"removeClass"]("bookmarked")},t.prototype.goto=function(n){$("#steps .current").removeClass(".current");var t=$($("#steps").find("li")[n]);this.showElStep(t)},t.prototype.canMove=function(){var n=new Date;return!this.lastNextOrBackTime||n.valueOf()-this.lastNextOrBackTime.valueOf()>700?(this.lastNextOrBackTime=n,!0):!1},t.prototype.next=function(){if(this.canMove()){var n=$("#steps").find("li.current"),t=n.next();t.length>0&&(this.showElStep(t),n.removeClass("current"))}},t.prototype.back=function(){if(this.canMove()){var n=$("#steps").find("li.current"),t=n.prev();t.length>0&&(this.showElStep(t),n.removeClass("current"))}},t.prototype.playCurrentAudio=function(){$("#steps li.current")[0].audio.play()},t.prototype.toggleBookmark=function(){var n=parseInt($("#steps li.current").attr("data-stepid")),t=this.bookmarks.toggleBookmark(this.levelNumber,n);$("body")[t?"addClass":"removeClass"]("bookmarked")},t}();n.Level=t})(PG||(PG={}))